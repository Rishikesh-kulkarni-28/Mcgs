<?php require_once __DIR__.'/includes/dbconnection.php'; require_once __DIR__.'/includes/functions.php'; require_once __DIR__.'/includes/header.php'; $card = null; $q = ''; if ($_SERVER['REQUEST_METHOD']==='POST') { $q = post('ref'); if ($q !== '') { $st = $dbh->prepare('SELECT * FROM tblmedicalcard WHERE RefNumber = ? LIMIT 1'); $st->execute([$q]); $card = $st->fetch(); } } ?> <h2>View Medical Card</h2> <form method="post" class="row g-3 mb-4"> <div class="col-auto"> <label for="ref" class="col-form-label">Reference Number</label> </div> <div class="col-auto"> <input type="text" class="form-control" id="ref" name="ref" value="<?php echo e($q); ?>" required> </div> <div class="col-auto"> <button class="btn btn-primary" type="submit">Search</button> </div> </form> <?php if ($card): ?> <div class="card p-3"> <div class="row align-items-center"> <div class="col-md-3"> <?php if (!empty($card['ProfileImage'])): ?> <img class="img-thumbnail" src="uploads/<?php echo e($card['ProfileImage']); ?>" alt="Photo"> <?php else: ?> <div class="bg-secondary text-white text-center p-5">No Photo</div> <?php endif; ?> </div> <div class="col-md-9"> <h4><?php echo e($card['FullName']); ?> <small class="text-muted">(#<?php echo e($card['RefNumber']); ?>)</small></h4> <div class="row"> <div class="col-sm-6"><strong>Mobile:</strong> <?php echo e($card['ContactNumber']); ?></div> <div class="col-sm-6"><strong>Email:</strong> <?php echo e($card['Email']); ?></div> <div class="col-sm-6"><strong>Blood Group:</strong> <?php echo e($card['BloodGroup']); ?></div> <div class="col-sm-6"><strong>Gender:</strong> <?php echo e($card['Gender']); ?></div> <div class="col-sm-12"><strong>Address:</strong> <?php echo e($card['Address']); ?></div> <div class="col-sm-12"><strong>Medical Conditions:</strong> <?php echo e($card['MedicalCond']); ?></div> <div class="col-sm-6"><strong>Issued:</strong> <?php echo e($card['IssuedDate']); ?></div> <div class="col-sm-6"><strong>Valid Upto:</strong> <?php echo e($card['ValidDate']); ?></div> </div> <div class="mt-3"> <button class="btn btn-outline-secondary" onclick="window.print()">Print</button> </div> </div> </div> </div> <?php elseif($_SERVER['REQUEST_METHOD']==='POST'): ?> <div class="alert alert-warning">No card found for the given reference number.</div> <?php endif; ?> <?php require_once __DIR__.'/includes/footer.php'; ?>