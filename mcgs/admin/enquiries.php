<?php require_once __DIR__ . '/../includes/dbconnection.php'; require_once __DIR__ . '/header.php'; // Handle mark-as-read action on this page
 if (isset($_GET['mark_read'])) { $mid = (int)$_GET['mark_read']; if ($mid > 0) { $dbh->prepare('UPDATE tblcontact SET IsRead = 1 WHERE ID = ?')->execute([$mid]); } header('Location: enquiries.php'); exit; } // Load list 
 $rows = $dbh->query('SELECT * FROM tblcontact ORDER BY EnquiryDate DESC')->fetchAll(PDO::FETCH_ASSOC); ?> <h3>Enquiries</h3> <div class="table-responsive"> <table class="table table-striped align-middle"> <thead> <tr> <th>#</th> <th>Name</th> <th>Email</th> <th>Date</th> <th>Status</th> <th style="width:260px">Action</th> </tr> </thead> <tbody> <?php foreach ($rows as $i=>$r): ?> <tr> <td><?php echo $i+1; ?></td> <td><?php echo htmlspecialchars($r['Name'] ?? ''); ?></td> <td><?php echo htmlspecialchars($r['Email'] ?? ''); ?></td> <td><?php echo htmlspecialchars($r['EnquiryDate'] ?? ''); ?></td> <td><?php echo ((int)($r['IsRead'] ?? 0) ? 'Read' : 'Unread'); ?></td> <td> <a class="btn btn-sm btn-secondary" href="enquiry-view.php?id=<?php echo (int)$r['ID']; ?>">View</a> <a class="btn btn-sm btn-outline-success" href="enquiries.php?mark_read=<?php echo (int)$r['ID']; ?>">Mark Read</a> <form method="post" action="/mcgs/admin/enquiry-delete.php" style="display:inline" onsubmit="return confirm('Delete enquiry?')"> <input type="hidden" name="id" value="<?php echo (int)$r['ID']; ?>"> <button class="btn btn-sm btn-danger">Delete</button> </form> </td> </tr> <?php endforeach; ?> </tbody> </table> </div> <?php require_once __DIR__ . '/footer.php'; ?>