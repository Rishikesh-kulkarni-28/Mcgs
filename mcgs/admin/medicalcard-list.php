<?php require_once __DIR__.'/../includes/dbconnection.php'; require_once __DIR__.'/header.php'; $q = $_GET['q'] ?? ''; $where = ''; $params = []; if ($q !== '') { $where = 'WHERE RefNumber = ? OR ContactNumber = ?'; $params = [$q,$q]; } $sql = "SELECT * FROM tblmedicalcard $where ORDER BY CreationDate DESC"; $st = $dbh->prepare($sql); $st->execute($params); $rows = $st->fetchAll(); ?> <h3>Medical Cards</h3> <form class="row g-2 mb-3"> <div class="col-auto"><input class="form-control" name="q" placeholder="RefNumber or Contact" value="<?php echo htmlspecialchars($q); ?>"></div> <div class="col-auto"><button class="btn btn-outline-primary">Search</button></div> <div class="col-auto"><a class="btn btn-success" href="medicalcard-add.php">Add New</a></div> </form> <div class="table-responsive"> <table class="table table-striped"> <thead><tr><th>#</th><th>RefNumber</th><th>Full Name</th><th>Contact</th><th>Email</th><th>Created</th><th>Actions</th></tr></thead> <tbody> <?php foreach($rows as $i=>$r): ?> <tr> <td><?php echo $i+1; ?></td> <td><?php echo htmlspecialchars($r['RefNumber']); ?></td> <td><?php echo htmlspecialchars($r['FullName']); ?></td> <td><?php echo htmlspecialchars($r['ContactNumber']); ?></td> <td><?php echo htmlspecialchars($r['Email']); ?></td> <td><?php echo htmlspecialchars($r['CreationDate']); ?></td> <td> <a class="btn btn-sm btn-secondary" href="medicalcard-view.php?id=<?php echo $r['ID']; ?>">View</a> <a class="btn btn-sm btn-primary" href="medicalcard-edit.php?id=<?php echo $r['ID']; ?>">Edit</a> <a class="btn btn-sm btn-danger" onclick="return confirm('Delete this card?')" href="medicalcard-delete.php?id=<?php echo $r['ID']; ?>">Delete</a> </td> </tr> <?php endforeach; ?> </tbody> </table> </div> <?php require_once __DIR__.'/footer.php'; ?> 