<?php require_once __DIR__.'/../includes/dbconnection.php'; require_once __DIR__.'/header.php'; $id = (int)$_SESSION['admin_id']; $msg=''; if ($_SERVER['REQUEST_METHOD']==='POST') { $old = $_POST['old'] ?? ''; $new = $_POST['new'] ?? ''; $cnf = $_POST['confirm'] ?? ''; $st = $dbh->prepare('SELECT Password FROM tbladmin WHERE ID=?'); $st->execute([$id]); $a = $st->fetch(); if (!$a) $msg='Account not found'; elseif (md5($old)!==$a['Password']) $msg='Old password incorrect'; elseif (strlen($new)<6) $msg='New password must be at least 6 chars'; elseif ($new!==$cnf) $msg='Passwords do not match'; else { $u = $dbh->prepare('UPDATE tbladmin SET Password=? WHERE ID=?'); $u->execute([md5($new),$id]); $msg='Password changed successfully'; } } ?> <h3>Change Password</h3> <?php if($msg): ?><div class="alert alert-info"><?php echo htmlspecialchars($msg); ?></div><?php endif; ?> <form method="post" class="card card-body" style="max-width:480px"> <div class="mb-3"><label class="form-label">Old Password</label><input type="password" name="old" class="form-control" required></div> <div class="mb-3"><label class="form-label">New Password</label><input type="password" name="new" class="form-control" required></div> <div class="mb-3"><label class="form-label">Confirm New Password</label><input type="password" name="confirm" class="form-control" required></div> <button class="btn btn-primary">Update</button> </form> <?php require_once __DIR__.'/footer.php'; ?>